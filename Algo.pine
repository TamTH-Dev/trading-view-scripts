// @version=6
indicator(title = "Algo", shorttitle = "Algo", overlay = true)


//-----------------------------------------------------------------------------*
//  Constants
//-----------------------------------------------------------------------------{
color TRANSPARENT_COLOR = color.new(#000000, 100)
color RED_COLOR = #FF525225
color GREEN_COLOR = #26A69A25
color BLUE_COLOR = #2962ff
color ORANGE_COLOR = #ff6d00


//-----------------------------------------------------------------------------*
// Settings
//-----------------------------------------------------------------------------{

// EMAs
emaGrp = "EMAs"
emaSrc = input.source(close, title = "Source", group = emaGrp)
emaFastLen = input.int(9, title = "Fast EMA", group = emaGrp)
emaMediumLen = input.int(21, title = "Medium EMA", group = emaGrp)
emaSlowLen = input.int(200, title = "Slow EMA", group = emaGrp)

// VWAP
vwapGrp = "VWAP"
vwapShowed = input.bool(true, title = "Show", group = vwapGrp)
vwapAnchor = input.string("Session", title = "Anchor Period", options = ["Session", "Week", "Month", "Quarter", "Year", "Decade", "Century", "Earnings", "Dividends", "Splits"], group = vwapGrp)


//-----------------------------------------------------------------------------*
// Values
//-----------------------------------------------------------------------------{
// EMAs
emaFast = ta.ema(emaSrc, emaFastLen)
emaMedium = ta.ema(emaSrc, emaMediumLen)
emaSlow = ta.ema(emaSrc, emaSlowLen)

// VWAP
vwapPeriod = switch vwapAnchor
	"Session"   => timeframe.change("D")
	"Week"      => timeframe.change("W")
	"Month"     => timeframe.change("M")
	"Quarter"   => timeframe.change("3M")
	"Year"      => timeframe.change("12M")
	"Decade"    => timeframe.change("12M") and year % 10 == 0
	"Century"   => timeframe.change("12M") and year % 100 == 0
	=> false
[vwap, _, _] = ta.vwap(close, vwapPeriod, 1)


//-----------------------------------------------------------------------------*
// Plots
//-----------------------------------------------------------------------------{

// VWAP
plot(vwapShowed ? vwap : na, color = BLUE_COLOR, linewidth = 1, display = display.pane)

// EMAs
emaFastPlot = plot(emaFast, color = TRANSPARENT_COLOR, linewidth = 1, display = display.pane)
emaMediumPlot = plot(emaMedium, color = TRANSPARENT_COLOR, linewidth = 1, display = display.pane)
fill(emaFastPlot, emaMediumPlot, emaFast > emaMedium ? GREEN_COLOR : RED_COLOR, title = "EMA Cloud", editable = false, fillgaps = false)
plot(emaSlow, color = ORANGE_COLOR, linewidth = 1, display = display.pane)
